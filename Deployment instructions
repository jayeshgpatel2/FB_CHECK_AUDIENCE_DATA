# ðŸ“¦ Deployment Instructions (Simple Steps)

## Part 1: Update Lambda Function

### Step 1: Open AWS Console
1. Go to https://aws.amazon.com
2. Log in to your account
3. Search for "Lambda" in the top search bar
4. Click on "Lambda"

### Step 2: Find Your Function
1. You'll see a list of your Lambda functions
2. Find the one that handles Facebook audiences
3. Click on it to open

### Step 3: Backup Old Code
1. Scroll down to the "Code" section
2. Click on `lambda_function.py` file
3. Copy ALL the code (Ctrl+A, then Ctrl+C)
4. Paste it in Notepad and save as "backup_lambda.py"
5. **Keep this safe!** (In case you need to go back)

### Step 4: Replace with New Code
1. Delete all the old code in the Lambda editor
2. Open the file `lambda_function_optimized.py` I created
3. Copy all the code from it
4. Paste into the Lambda editor
5. Click "Deploy" button (orange button at top)
6. Wait for "Successfully deployed" message

### Step 5: Update Settings
1. Click on "Configuration" tab
2. Click on "General configuration"
3. Click "Edit" button
4. Change these settings:
   - **Timeout:** 30 seconds (was probably 3 seconds)
   - **Memory:** 512 MB (was probably 128 MB)
5. Click "Save"

### Step 6: Add Environment Variable (Optional)
1. Still in "Configuration" tab
2. Click on "Environment variables"
3. Click "Edit"
4. Click "Add environment variable"
5. Add:
   - **Key:** `CACHE_MINUTES`
   - **Value:** `5`
6. Click "Save"

### Step 7: Test It
1. Go back to "Test" tab
2. Click "Test" button
3. Check if it runs without errors
4. Look for "Successfully deployed" or similar message

---

## Part 2: Update HTML Dashboard

### Step 1: Open GitHub
1. Go to your GitHub repository
2. Find the file `index.html`
3. Click on it

### Step 2: Backup Old HTML
1. Click the "Raw" button
2. Copy all the HTML code (Ctrl+A, then Ctrl+C)
3. Paste in Notepad and save as "backup_index.html"
4. **Keep this safe!**

### Step 3: Edit the File
1. Go back to GitHub
2. Click the pencil icon (Edit this file)
3. Delete all the old HTML
4. Open `index_optimized.html` I created
5. Copy all the code from it
6. Paste into GitHub editor

### Step 4: Update API URL
**IMPORTANT:** Find this line (around line 285):
```javascript
const API_URL = "https://h8lw9x6z4g.execute-api.ap-south-1.amazonaws.com/audiences";
```

Replace with YOUR actual API Gateway URL:
```javascript
const API_URL = "https://YOUR-API-ID.execute-api.YOUR-REGION.amazonaws.com/audiences";
```

To find your API URL:
1. Go to AWS Console
2. Search for "API Gateway"
3. Find your API
4. Copy the "Invoke URL"

### Step 5: Save Changes
1. Scroll to bottom of page
2. In "Commit changes" box, write: "Updated dashboard with optimizations"
3. Click "Commit changes" button

### Step 6: Wait for Deployment
1. Go to "Actions" tab in GitHub
2. Wait for the green checkmark (usually 1-2 minutes)
3. Your site will auto-update

### Step 7: Test It
1. Open your GitHub Pages URL in browser
2. Example: `https://yourusername.github.io/repo-name/`
3. The new dashboard should load
4. Try clicking buttons and searching

---

## Troubleshooting

### Problem: Lambda returns error
**Fix:**
1. Check if environment variables are set:
   - `FB_ACCESS_TOKEN`
   - `FB_AD_ACCOUNT_ID`
   - `DDB_TABLE_NAME`
2. Go to Lambda â†’ Configuration â†’ Environment variables
3. Make sure all three are there

### Problem: Dashboard shows "Error loading data"
**Fix:**
1. Open browser console (Press F12)
2. Look for error message
3. Usually it's wrong API URL
4. Double-check the `API_URL` in HTML

### Problem: "CORS error" in browser
**Fix:**
1. Go to API Gateway in AWS
2. Find your API
3. Click on your endpoint
4. Enable CORS:
   - Click "Actions" â†’ "Enable CORS"
   - Click "Yes, replace existing"

### Problem: Data not updating
**Fix:**
1. Click "Force Update" button
2. Wait 10-20 seconds
3. Click "Refresh" button

### Problem: Auto-refresh not working
**Fix:**
1. Make sure checkbox is ticked
2. Check browser console for errors
3. Try refreshing page

---

## How to Know It's Working

### Lambda Function:
âœ… Should see this in CloudWatch Logs:
```
INFO Fetched 156 audiences from Facebook
INFO Saved 156 items to DynamoDB
```

### Dashboard:
âœ… Should see:
- Statistics cards with numbers
- Search box working
- Filter dropdown working
- Sort arrows on columns
- "Last updated: X min ago"

---

## Quick Checklist

Before deploying:
- [ ] Backed up old Lambda code
- [ ] Backed up old HTML
- [ ] Have AWS credentials
- [ ] Know your API Gateway URL

After deploying Lambda:
- [ ] Changed timeout to 30 seconds
- [ ] Changed memory to 512 MB
- [ ] Tested function (no errors)
- [ ] Checked CloudWatch logs

After deploying HTML:
- [ ] Updated API_URL with correct endpoint
- [ ] Committed changes to GitHub
- [ ] Waited for GitHub Actions to finish
- [ ] Tested website in browser

---

## Rollback Plan (If Something Breaks)

### To Rollback Lambda:
1. Open Lambda function
2. Delete new code
3. Paste your backup code
4. Click "Deploy"
5. Done!

### To Rollback HTML:
1. Go to GitHub
2. Click on `index.html`
3. Click "History" button
4. Find your backup version
5. Click "..." â†’ "Revert this commit"
6. Done!

---

## Performance Test

After deploying, test these:

1. **Speed Test:**
   - Open dashboard
   - Click "Refresh"
   - Should load in 5-10 seconds (was 15-20 before)

2. **Search Test:**
   - Type in search box
   - Results should filter instantly

3. **Sort Test:**
   - Click column headers
   - Table should resort

4. **Filter Test:**
   - Select "Errors Only" in dropdown
   - Should show only error audiences

5. **Force Refresh Test:**
   - Click "Force Update"
   - Wait for confirmation
   - Data should update from Facebook

---

## Getting Help

If you're stuck:

1. **Check CloudWatch Logs:**
   - AWS Console â†’ CloudWatch â†’ Logs
   - Look for your Lambda function
   - Read error messages

2. **Check Browser Console:**
   - Press F12 in browser
   - Click "Console" tab
   - Look for red error messages

3. **Common Fixes:**
   - Wrong API URL â†’ Update in HTML
   - Timeout error â†’ Increase Lambda timeout
   - CORS error â†’ Enable CORS in API Gateway
   - No data â†’ Click "Force Update"

---

## What to Expect

### First Time Loading:
1. Dashboard opens â†’ Shows "Loading..."
2. After 2-5 seconds â†’ Stats appear
3. After 3-6 seconds â†’ Table fills with data

### After Force Update:
1. Click "Force Update" button
2. Shows "Updating..." for 10-20 seconds
3. Alert: "Updated X audiences"
4. Dashboard refreshes automatically

### Auto-Refresh Mode:
1. Check the "Auto-refresh" box
2. Every 60 seconds, data refreshes
3. Loading bar shows when refreshing
4. Numbers update automatically

---

## Success Criteria

You'll know it's working when:

âœ… Dashboard loads in under 10 seconds
âœ… Statistics show correct numbers
âœ… Search box filters instantly
âœ… Clicking columns sorts the table
âœ… Status badges show colors (green/yellow/red)
âœ… "Last updated" shows recent time
âœ… Force update fetches from Facebook
âœ… No error messages appear

---

## Next Steps

After successful deployment:

1. **Monitor for a day**
   - Check if auto-refresh works
   - Look for any errors
   - Compare with old version

2. **Optimize further** (optional)
   - Add more filters
   - Export to CSV
   - Email alerts

3. **Share with team**
   - Send them the URL
   - Show them new features
   - Get feedback

---

## Support

If you need help:
- Check the OPTIMIZATION_GUIDE.md file
- Check the BEFORE_AFTER_COMPARISON.md file
- Look at CloudWatch logs for errors
- Test each feature one by one

Remember: You have backups! If anything breaks, you can always go back to the old version.
